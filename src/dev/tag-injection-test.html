<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Tag Injection Test - ChatGPT Simulator</title>\n    <style>\n        :root {\n            /* Mock ChatGPT CSS variables */\n            --ix-color-bg-primary: #ffffff;\n            --ix-color-bg-secondary: #f9fafb;\n            --ix-color-text-primary: #1f2937;\n            --ix-color-text-secondary: #6b7280;\n            --ix-color-border-primary: #d1d5db;\n            --ix-color-border-secondary: #e5e7eb;\n            --ix-color-focus: #3b82f6;\n            --ix-color-bg-primary-action: #3b82f6;\n            --ix-color-bg-primary-action-hover: #2563eb;\n            --ix-color-bg-warning: #fef3c7;\n            --ix-color-border-warning: #fbbf24;\n            --ix-color-text-warning: #92400e;\n            --ix-color-bg-error: #fef2f2;\n            --ix-color-border-error: #fca5a5;\n            --ix-color-text-error: #dc2626;\n            --ix-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            --ix-font-size-xs: 0.75rem;\n            --ix-font-size-sm: 0.875rem;\n            --ix-font-size-lg: 1.125rem;\n            --ix-spacing-xs: 0.25rem;\n            --ix-spacing-sm: 0.5rem;\n            --ix-spacing-md: 0.75rem;\n            --ix-border-radius: 0.375rem;\n        }\n\n        body {\n            font-family: var(--ix-font-family);\n            background: var(--ix-color-bg-primary);\n            color: var(--ix-color-text-primary);\n            margin: 0;\n            padding: 20px;\n            line-height: 1.6;\n        }\n\n        .page-header {\n            text-align: center;\n            margin-bottom: 2rem;\n            padding: 1rem;\n            background: var(--ix-color-bg-secondary);\n            border-radius: var(--ix-border-radius);\n            border: 1px solid var(--ix-color-border-secondary);\n        }\n\n        .conversation-container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n        }\n\n        .conversation-header {\n            padding: 1rem;\n            background: var(--ix-color-bg-secondary);\n            border-bottom: 1px solid var(--ix-color-border-secondary);\n        }\n\n        .conversation-title {\n            font-size: 1.25rem;\n            font-weight: 600;\n            margin: 0;\n            color: var(--ix-color-text-primary);\n        }\n\n        .conversation-meta {\n            font-size: var(--ix-font-size-sm);\n            color: var(--ix-color-text-secondary);\n            margin-top: 0.5rem;\n        }\n\n        .message {\n            padding: 1rem;\n            border-bottom: 1px solid var(--ix-color-border-secondary);\n        }\n\n        .message:last-child {\n            border-bottom: none;\n        }\n\n        .message-author {\n            font-weight: 600;\n            color: var(--ix-color-text-primary);\n            margin-bottom: 0.5rem;\n        }\n\n        .message-content {\n            color: var(--ix-color-text-primary);\n            line-height: 1.6;\n        }\n\n        .user-message {\n            background: var(--ix-color-bg-primary);\n        }\n\n        .assistant-message {\n            background: var(--ix-color-bg-secondary);\n        }\n\n        .test-controls {\n            margin: 2rem auto;\n            max-width: 800px;\n            display: flex;\n            gap: 1rem;\n            justify-content: center;\n            flex-wrap: wrap;\n        }\n\n        .test-button {\n            padding: 0.5rem 1rem;\n            background: var(--ix-color-bg-primary-action);\n            color: white;\n            border: none;\n            border-radius: var(--ix-border-radius);\n            cursor: pointer;\n            font-size: var(--ix-font-size-sm);\n            transition: background-color 0.2s;\n        }\n\n        .test-button:hover {\n            background: var(--ix-color-bg-primary-action-hover);\n        }\n\n        .test-button:disabled {\n            opacity: 0.5;\n            cursor: not-allowed;\n        }\n\n        .status-panel {\n            max-width: 800px;\n            margin: 1rem auto;\n            padding: 1rem;\n            background: var(--ix-color-bg-secondary);\n            border-radius: var(--ix-border-radius);\n            border: 1px solid var(--ix-color-border-secondary);\n        }\n\n        .status-title {\n            font-weight: 600;\n            margin-bottom: 0.5rem;\n            color: var(--ix-color-text-primary);\n        }\n\n        .status-content {\n            font-size: var(--ix-font-size-sm);\n            color: var(--ix-color-text-secondary);\n            font-family: monospace;\n            white-space: pre-wrap;\n        }\n\n        .extension-notice {\n            background: var(--ix-color-bg-warning);\n            border: 1px solid var(--ix-color-border-warning);\n            color: var(--ix-color-text-warning);\n            padding: 1rem;\n            border-radius: var(--ix-border-radius);\n            margin-bottom: 1rem;\n            text-align: center;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"page-header\">\n        <h1>Tag Injection Test Page</h1>\n        <p>Simulates ChatGPT conversation layout for testing TagManager injection</p>\n    </div>\n\n    <div class=\"extension-notice\">\n        <strong>⚠️ Extension Required</strong><br>\n        Load the Ishka extension in Chrome and reload this page to test tag injection.\n    </div>\n\n    <div class=\"test-controls\">\n        <button class=\"test-button\" onclick=\"simulateNewConversation()\">Add New Conversation</button>\n        <button class=\"test-button\" onclick=\"simulatePageNavigation()\">Simulate Navigation</button>\n        <button class=\"test-button\" onclick=\"toggleSafeMode()\">Toggle Safe Mode</button>\n        <button class=\"test-button\" onclick=\"clearLogs()\">Clear Logs</button>\n    </div>\n\n    <div class=\"status-panel\">\n        <div class=\"status-title\">Extension Status</div>\n        <div class=\"status-content\" id=\"status-log\">Waiting for extension to load...</div>\n    </div>\n\n    <!-- Sample Conversation -->\n    <main role=\"main\" class=\"conversation-container\" data-conversation-id=\"test-conv-1\">\n        <div class=\"conversation-header\">\n            <h2 class=\"conversation-title\">Test Conversation: JavaScript Best Practices</h2>\n            <div class=\"conversation-meta\">Created: Today • Messages: 4</div>\n        </div>\n        \n        <div class=\"message user-message\" data-message-id=\"msg-1\" data-message-author-role=\"user\">\n            <div class=\"message-author\">You</div>\n            <div class=\"message-content markdown\">What are some JavaScript best practices for modern web development?</div>\n        </div>\n        \n        <div class=\"message assistant-message\" data-message-id=\"msg-2\" data-message-author-role=\"assistant\">\n            <div class=\"message-author\">ChatGPT</div>\n            <div class=\"message-content markdown\">Here are some essential JavaScript best practices for modern web development:\n\n1. **Use Modern ES6+ Features**\n   - Arrow functions for cleaner syntax\n   - Template literals for string interpolation\n   - Destructuring for easier data extraction\n\n2. **Follow Consistent Code Style**\n   - Use a linter like ESLint\n   - Consistent naming conventions\n   - Proper indentation and spacing</div>\n        </div>\n\n        <div class=\"message user-message\" data-message-id=\"msg-3\" data-message-author-role=\"user\">\n            <div class=\"message-author\">You</div>\n            <div class=\"message-content markdown\">Can you give me specific examples of arrow functions vs regular functions?</div>\n        </div>\n\n        <div class=\"message assistant-message\" data-message-id=\"msg-4\" data-message-author-role=\"assistant\">\n            <div class=\"message-author\">ChatGPT</div>\n            <div class=\"message-content markdown\">Certainly! Here are some examples comparing arrow functions and regular functions:\n\n**Regular Function:**\n```javascript\nfunction add(a, b) {\n    return a + b;\n}\n```\n\n**Arrow Function:**\n```javascript\nconst add = (a, b) => a + b;\n```</div>\n        </div>\n    </main>\n\n    <!-- Second Sample Conversation -->\n    <main role=\"main\" class=\"conversation-container\" data-conversation-id=\"test-conv-2\" style=\"margin-top: 2rem;\">\n        <div class=\"conversation-header\">\n            <h2 class=\"conversation-title\">Test Conversation: React Development</h2>\n            <div class=\"conversation-meta\">Created: Yesterday • Messages: 2</div>\n        </div>\n        \n        <div class=\"message user-message\" data-message-id=\"msg-5\" data-message-author-role=\"user\">\n            <div class=\"message-author\">You</div>\n            <div class=\"message-content markdown\">How do I optimize React component performance?</div>\n        </div>\n        \n        <div class=\"message assistant-message\" data-message-id=\"msg-6\" data-message-author-role=\"assistant\">\n            <div class=\"message-author\">ChatGPT</div>\n            <div class=\"message-content markdown\">Here are key strategies to optimize React component performance:\n\n1. **Use React.memo for functional components**\n2. **Implement useMemo and useCallback hooks**\n3. **Lazy load components with React.lazy**\n4. **Avoid unnecessary re-renders**</div>\n        </div>\n    </main>\n\n    <script>\n        // Mock ChatGPT-like behavior for testing\n        let conversationCount = 2;\n        const statusLog = document.getElementById('status-log');\n        \n        function logStatus(message) {\n            const timestamp = new Date().toLocaleTimeString();\n            statusLog.textContent += `[${timestamp}] ${message}\\n`;\n            statusLog.scrollTop = statusLog.scrollHeight;\n        }\n        \n        function clearLogs() {\n            statusLog.textContent = 'Logs cleared.\\n';\n        }\n        \n        function simulateNewConversation() {\n            conversationCount++;\n            const newConv = document.createElement('main');\n            newConv.setAttribute('role', 'main');\n            newConv.className = 'conversation-container';\n            newConv.setAttribute('data-conversation-id', `test-conv-${conversationCount}`);\n            newConv.style.marginTop = '2rem';\n            \n            newConv.innerHTML = `\n                <div class=\"conversation-header\">\n                    <h2 class=\"conversation-title\">New Test Conversation ${conversationCount}</h2>\n                    <div class=\"conversation-meta\">Created: Just now • Messages: 1</div>\n                </div>\n                \n                <div class=\"message user-message\" data-message-id=\"msg-new-${conversationCount}\" data-message-author-role=\"user\">\n                    <div class=\"message-author\">You</div>\n                    <div class=\"message-content markdown\">This is a new conversation to test dynamic tag injection.</div>\n                </div>\n            `;\n            \n            document.body.appendChild(newConv);\n            logStatus(`Added new conversation: test-conv-${conversationCount}`);\n        }\n        \n        function simulatePageNavigation() {\n            logStatus('Simulating page navigation...');\n            // Change URL to simulate ChatGPT navigation\n            window.history.pushState({}, '', `/c/test-conv-${Math.floor(Math.random() * 1000)}`);\n            logStatus('URL changed to simulate ChatGPT conversation navigation');\n        }\n        \n        function toggleSafeMode() {\n            logStatus('Toggling Safe Mode (if extension is loaded)');\n            // This would interact with the extension's Safe Mode system\n            if (window.ishkaExtension) {\n                window.ishkaExtension.toggleSafeMode();\n            } else {\n                logStatus('Extension not detected - Safe Mode toggle unavailable');\n            }\n        }\n        \n        // Check for extension\n        function checkExtension() {\n            if (document.getElementById('ishka-diagnostic-element-present')) {\n                logStatus('✅ Ishka extension detected!');\n                \n                // Check for injected tag managers\n                const tagManagers = document.querySelectorAll('[data-ishka-component=\"tag-manager\"]');\n                if (tagManagers.length > 0) {\n                    logStatus(`✅ Found ${tagManagers.length} injected TagManager component(s)`);\n                } else {\n                    logStatus('⏳ TagManager components not yet injected');\n                }\n            } else {\n                logStatus('❌ Extension not detected');\n            }\n        }\n        \n        // Check for extension periodically\n        setInterval(checkExtension, 2000);\n        \n        // Initial check\n        setTimeout(checkExtension, 1000);\n        \n        // Log initial status\n        logStatus('Test page loaded. Looking for Ishka extension...');\n        \n        // Expose test functions globally\n        window.ishkaTestPage = {\n            simulateNewConversation,\n            simulatePageNavigation,\n            toggleSafeMode,\n            clearLogs,\n            checkExtension\n        };\n    </script>\n</body>\n</html>